# Глобальные настройки
weekly
rotate 4
compress
compressext .zip
create

# Включение дополнительных конфигураций
include conf.d/*.conf

# Ротация для IIS логов
C:\inetpub\logs\LogFiles\W3SVC*\*.log {
    daily
    rotate 7
    copytruncate
    missingok
    notifempty
    
    prerotate
        Write-Host "Начинаем ротацию логов IIS"
    endscript
    
    postrotate
        # Restart-Service -Name W3SVC -Force
        Write-Host "Ротация логов IIS завершена"
    endscript
}

# Ротация для логов приложения
C:\logs\app\*.log {
    size 10M
    monthly
    rotate 12
    compress
    dateext
    dateformat -%Y%m%d-%s
    
    postrotate
        # Restart-Service -Name MyAppService -Force
    endscript
}

# Ротация для Windows Event логов
C:\Logs\EventLogs\*.evtx {
    yearly
    rotate 5
    compress
    compresscmd "PowerShell -Command Compress-Archive"
    notifempty
}

# Ротация журналов SQL Server
C:\Program Files\Microsoft SQL Server\*\MSSQL\Log\ERRORLOG* {
    daily
    rotate 14
    missingok
    compress
    
    prerotate
        # Код для бэкапа базы данных
    endscript
} 