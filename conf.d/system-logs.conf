# Конфигурация для экспортированных системных журналов
C:\Logs\System\*.evtx {
    monthly
    rotate 24          # Хранить 2 года
    compress
    missingok
    notifempty
    create
    
    prerotate
        $date = Get-Date -Format "yyyy-MM-dd"
        $logName = "System"
        $exportPath = "C:\Logs\System\SystemLog-$date.evtx"
        # wevtutil epl System $exportPath
        Write-Host "Журнал системы экспортирован в $exportPath"
    endscript
    
    postrotate
        # wevtutil cl System
        Write-Host "Системный журнал очищен"
    endscript
}

# Конфигурация для журналов безопасности
C:\Logs\Security\*.evtx {
    weekly
    rotate 52          # Хранить год
    compress
    missingok
    notifempty
    compresscmd "PowerShell -Command { Compress-Archive -Path '%1' -DestinationPath '%2'; Protect-CmsMessage -Path '%2' -To 'cn=LogAdmin' }"
    
    prerotate
        $date = Get-Date -Format "yyyy-MM-dd"
        $logName = "Security"
        $exportPath = "C:\Logs\Security\SecurityLog-$date.evtx"
        # wevtutil epl Security $exportPath
        Write-Host "Журнал безопасности экспортирован в $exportPath"
    endscript
}

# Конфигурация для журналов приложений
C:\Logs\Application\*.evtx {
    daily
    rotate 30          # Хранить месяц
    compress
    missingok
    notifempty
    maxage 31
    
    prerotate
        $date = Get-Date -Format "yyyy-MM-dd"
        $logName = "Application"
        $exportPath = "C:\Logs\Application\ApplicationLog-$date.evtx"
        # wevtutil epl Application $exportPath
        Write-Host "Журнал приложений экспортирован в $exportPath"
    endscript
} 